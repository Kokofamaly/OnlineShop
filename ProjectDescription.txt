Отлично! Давай составим **чёткое, понятное и реалистичное ТЗ** для твоего мини-магазина, которое можно положить в репозиторий и по которому реально работать. Я оформлю его так, чтобы сразу было понятно, что делать: таблицы, API, Docker.

---

# ТЗ: Мини-магазин (Backend + PostgreSQL + Docker)

### Цель проекта

Создать REST API для мини-магазина, где пользователи могут просматривать товары, оформлять заказы и управлять своими аккаунтами. Проект должен работать в контейнерах через Docker.

---

## 1️⃣ Основные сущности

### 1.1 Products (Товары)

| Поле        | Тип     | Описание             |
| ----------- | ------- | -------------------- |
| Id          | int     | Первичный ключ       |
| Name        | string  | Название товара      |
| Description | string  | Описание товара      |
| Price       | decimal | Цена                 |
| Stock       | int     | Количество на складе |

### 1.2 Users (Пользователи)

| Поле         | Тип    | Описание          |
| ------------ | ------ | ----------------- |
| Id           | int    | Первичный ключ    |
| Name         | string | Имя пользователя  |
| Email        | string | Email, уникальный |
| PasswordHash | string | Хеш пароля        |

### 1.3 Orders (Заказы)

| Поле      | Тип      | Описание              |
| --------- | -------- | --------------------- |
| Id        | int      | Первичный ключ        |
| UserId    | int      | Внешний ключ к Users  |
| CreatedAt | datetime | Дата и время создания |
| Total     | decimal  | Итоговая сумма заказа |

### 1.4 OrderItems (Элементы заказа)

| Поле      | Тип     | Описание                |
| --------- | ------- | ----------------------- |
| Id        | int     | Первичный ключ          |
| OrderId   | int     | Внешний ключ к Orders   |
| ProductId | int     | Внешний ключ к Products |
| Quantity  | int     | Количество              |
| Price     | decimal | Цена на момент заказа   |

---

## 2️⃣ REST API Endpoints (MVP)

### 2.1 Users

* `POST /users/register` — регистрация нового пользователя
* `POST /users/login` — авторизация, возвращает JWT или токен

### 2.2 Products

* `GET /products` — список всех товаров
* `GET /products/{id}` — информация о конкретном товаре

### 2.3 Orders

* `POST /orders` — создание нового заказа
* `GET /orders/{id}` — получение конкретного заказа
* `GET /orders` — список всех заказов пользователя

---

## 3️⃣ Технологии

* Backend: C# ASP.NET Core Web API
* ORM: Entity Framework Core
* База данных: PostgreSQL
* Docker + docker-compose: для API и БД
* Swagger: для тестирования API

---

## 4️⃣ Docker

### 4.1 Dockerfile (API)

* Multi-stage build: сборка с SDK, потом runtime
* Рабочая директория `/app`
* CMD / ENTRYPOINT = `dotnet MyShop.dll`

### 4.2 docker-compose.yml

* Сервисы:

  * `api` — твой ASP.NET Core API
  * `db` — PostgreSQL
* Связь: API подключается к DB по имени сервиса `db`
* Volume для хранения данных PostgreSQL

---

## 5️⃣ Минимальная логика

1. При регистрации пользователя хешируем пароль
2. При создании заказа проверяем наличие товаров на складе
3. Итоговая сумма заказа = сумма всех OrderItems
4. Stock уменьшается после успешного создания заказа

---

## 6️⃣ MVP Scope

* Только backend + API + DB
* Frontend можно добавлять позже (Postman / Swagger достаточно для тестов)
* Основная цель: рабочее приложение с Docker, которое можно поднять на любой машине

---

## 7️⃣ Дополнительные опциональные фичи (для расширения)

* Авторизация через JWT
* Pagination и фильтры для `GET /products`
* Логирование и глобальная обработка ошибок
* Background job: уведомления пользователю о новом заказе

---

## 8️⃣ Рекомендации по реализации

1. Сначала создаём **модели и миграции** EF Core + SQLite для простоты
2. Потом переключаем на **PostgreSQL через Docker**
3. Используем `docker-compose up` для запуска всего стека
4. Тестируем API через Swagger / Postman
5. Потом добавляем расширения: авторизация, фоновые задачи, фронт

---

Если хочешь, я могу прямо **сразу нарисовать готовую структуру репозитория**:

* папки для API, моделей, migrations
* пример Dockerfile
* docker-compose.yml
* README с инструкцией “как поднять”

Это будет **готовый стартовый каркас проекта**, по которому реально писать код.

Хочешь, чтобы я сделал такой стартовый каркас?
